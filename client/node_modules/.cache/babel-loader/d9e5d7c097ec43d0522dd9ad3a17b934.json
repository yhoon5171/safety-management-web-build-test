{"ast":null,"code":"import _regeneratorRuntime from\"D:/\\uACF5\\uD504\\uAE30/Capstone test/BlockchainSafetyManagement/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/\\uACF5\\uD504\\uAE30/Capstone test/BlockchainSafetyManagement/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/\\uACF5\\uD504\\uAE30/Capstone test/BlockchainSafetyManagement/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Form,Button,Badge,ProgressBar,Container}from'react-bootstrap';import{create as ipfsHttpClient}from'ipfs-http-client';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var ipfs=ipfsHttpClient('https://ipfs.infura.io:5001/api/v0');export var FileUpload=function FileUpload(_ref){var setUrl=_ref.setUrl,setIpfs=_ref.setIpfs;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),fileUrl=_useState4[0],setFileUrl=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),uploaded=_useState8[0],setUploaded=_useState8[1];var uploadFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var added,url;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);e.preventDefault();_context.prev=2;_context.next=5;return ipfs.add(file);case 5:added=_context.sent;url=\"https://ipfs.infura.io/ipfs/\".concat(added.path);setUrl(url);setFileUrl(url);setUploaded(true);setIpfs(added.path);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](2);console.log('Error uploading the file : ',_context.t0);case 16:setLoading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,13]]);}));return function uploadFile(_x){return _ref2.apply(this,arguments);};}();var preUpload=function preUpload(e){if(e.target.value!==''){setFile(e.target.files[0]);}else{setFile({});}};var fileAndUploadButton=function fileAndUploadButton(){if(file.name){if(!loading){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[file.name,\" \",/*#__PURE__*/_jsxs(Badge,{pill:true,children:[file.size,\" kb\"]})]}),uploaded?/*#__PURE__*/_jsxs(\"h5\",{children:[\"\\u2705\",' ',/*#__PURE__*/_jsx(\"a\",{href:fileUrl,target:\"_blank\",rel:\"noopener noreferrer\",children:\"File\"}),' ',\"Uploaded Successfully \\u2705\"]}):/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Upload File\"})]});}else{return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Uploading File\"}),/*#__PURE__*/_jsx(ProgressBar,{animated:true,now:100}),/*#__PURE__*/_jsx(\"h4\",{children:\"Please Wait ...\"})]});}}};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form,{onSubmit:uploadFile,children:[/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"file\",onChange:function onChange(e){return preUpload(e);},className:\"mb-3\"}),fileAndUploadButton()]})});};","map":{"version":3,"names":["React","useState","Form","Button","Badge","ProgressBar","Container","create","ipfsHttpClient","ipfs","FileUpload","setUrl","setIpfs","file","setFile","fileUrl","setFileUrl","loading","setLoading","uploaded","setUploaded","uploadFile","e","preventDefault","add","added","url","path","console","log","preUpload","target","value","files","fileAndUploadButton","name","size"],"sources":["D:/공프기/Capstone test/BlockchainSafetyManagement/client/src/components/FileUpload.js"],"sourcesContent":["import React, { useState } from 'react'\r\nimport { Form, Button, Badge, ProgressBar, Container } from 'react-bootstrap'\r\nimport { create as ipfsHttpClient } from 'ipfs-http-client'\r\nconst ipfs = ipfsHttpClient('https://ipfs.infura.io:5001/api/v0')\r\n\r\nexport const FileUpload = ({ setUrl, setIpfs }) => {\r\n    const [file, setFile] = useState({})\r\n    const [fileUrl, setFileUrl] = useState('')\r\n    const [loading, setLoading] = useState(false)\r\n    const [uploaded, setUploaded] = useState(false)\r\n\r\n    const uploadFile = async (e) => {\r\n        setLoading(true)\r\n        e.preventDefault()\r\n\r\n        try {\r\n            const added = await ipfs.add(file)\r\n            const url = `https://ipfs.infura.io/ipfs/${added.path}`\r\n            setUrl(url)\r\n            setFileUrl(url)\r\n            setUploaded(true)\r\n            setIpfs(added.path)\r\n        } catch (err) {\r\n            console.log('Error uploading the file : ', err)\r\n        }\r\n        setLoading(false)\r\n    }\r\n\r\n    const preUpload = (e) => {\r\n        if (e.target.value !== '') {\r\n            setFile(e.target.files[0])\r\n        } else {\r\n            setFile({})\r\n        }\r\n    }\r\n\r\n    const fileAndUploadButton = () => {\r\n        if (file.name) {\r\n            if (!loading) {\r\n                return (\r\n                    <div>\r\n                        <h5>\r\n                            {file.name} <Badge pill>{file.size} kb</Badge>\r\n                        </h5>\r\n\r\n                        {uploaded ? (\r\n                            <h5>\r\n                                ✅{' '}\r\n                                <a\r\n                                    href={fileUrl}\r\n                                    target='_blank'\r\n                                    rel='noopener noreferrer'\r\n                                >\r\n                                    File\r\n                                </a>{' '}\r\n                                Uploaded Successfully ✅\r\n                            </h5>\r\n                        ) : (\r\n                            <Button type='submit'>Upload File</Button>\r\n                        )}\r\n                    </div>\r\n                )\r\n            } else {\r\n                return (\r\n                    <Container>\r\n                        <h4>Uploading File</h4>\r\n                        <ProgressBar animated now={100} />\r\n                        <h4>Please Wait ...</h4>\r\n                    </Container>\r\n                )\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Form onSubmit={uploadFile}>\r\n                <Form.Control\r\n                    required\r\n                    type='file'\r\n                    onChange={(e) => preUpload(e)}\r\n                    className='mb-3'\r\n                />\r\n\r\n                {fileAndUploadButton()}\r\n            </Form>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"ieAAA,MAAOA,MAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,IAAT,CAAeC,MAAf,CAAuBC,KAAvB,CAA8BC,WAA9B,CAA2CC,SAA3C,KAA4D,iBAA5D,CACA,OAASC,MAAM,GAAIC,eAAnB,KAAyC,kBAAzC,C,wFACA,GAAMC,KAAI,CAAGD,cAAc,CAAC,oCAAD,CAA3B,CAEA,MAAO,IAAME,WAAU,CAAG,QAAbA,WAAa,MAAyB,IAAtBC,OAAsB,MAAtBA,MAAsB,CAAdC,OAAc,MAAdA,OAAc,CAC/C,cAAwBX,QAAQ,CAAC,EAAD,CAAhC,wCAAOY,IAAP,eAAaC,OAAb,eACA,eAA8Bb,QAAQ,CAAC,EAAD,CAAtC,yCAAOc,OAAP,eAAgBC,UAAhB,eACA,eAA8Bf,QAAQ,CAAC,KAAD,CAAtC,yCAAOgB,OAAP,eAAgBC,UAAhB,eACA,eAAgCjB,QAAQ,CAAC,KAAD,CAAxC,yCAAOkB,QAAP,eAAiBC,WAAjB,eAEA,GAAMC,WAAU,6FAAG,iBAAOC,CAAP,kIACfJ,UAAU,CAAC,IAAD,CAAV,CACAI,CAAC,CAACC,cAAF,GAFe,sCAKSd,KAAI,CAACe,GAAL,CAASX,IAAT,CALT,QAKLY,KALK,eAMLC,GANK,uCAMgCD,KAAK,CAACE,IANtC,EAOXhB,MAAM,CAACe,GAAD,CAAN,CACAV,UAAU,CAACU,GAAD,CAAV,CACAN,WAAW,CAAC,IAAD,CAAX,CACAR,OAAO,CAACa,KAAK,CAACE,IAAP,CAAP,CAVW,iFAYXC,OAAO,CAACC,GAAR,CAAY,6BAAZ,cAZW,QAcfX,UAAU,CAAC,KAAD,CAAV,CAde,qEAAH,kBAAVG,WAAU,6CAAhB,CAiBA,GAAMS,UAAS,CAAG,QAAZA,UAAY,CAACR,CAAD,CAAO,CACrB,GAAIA,CAAC,CAACS,MAAF,CAASC,KAAT,GAAmB,EAAvB,CAA2B,CACvBlB,OAAO,CAACQ,CAAC,CAACS,MAAF,CAASE,KAAT,CAAe,CAAf,CAAD,CAAP,CACH,CAFD,IAEO,CACHnB,OAAO,CAAC,EAAD,CAAP,CACH,CACJ,CAND,CAQA,GAAMoB,oBAAmB,CAAG,QAAtBA,oBAAsB,EAAM,CAC9B,GAAIrB,IAAI,CAACsB,IAAT,CAAe,CACX,GAAI,CAAClB,OAAL,CAAc,CACV,mBACI,oCACI,sBACKJ,IAAI,CAACsB,IADV,kBACgB,MAAC,KAAD,EAAO,IAAI,KAAX,WAAatB,IAAI,CAACuB,IAAlB,SADhB,GADJ,CAKKjB,QAAQ,cACL,+BACM,GADN,cAEI,UACI,IAAI,CAAEJ,OADV,CAEI,MAAM,CAAC,QAFX,CAGI,GAAG,CAAC,qBAHR,kBAFJ,CAQS,GART,kCADK,cAaL,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,yBAlBR,GADJ,CAuBH,CAxBD,IAwBO,CACH,mBACI,MAAC,SAAD,yBACI,sCADJ,cAEI,KAAC,WAAD,EAAa,QAAQ,KAArB,CAAsB,GAAG,CAAE,GAA3B,EAFJ,cAGI,uCAHJ,GADJ,CAOH,CACJ,CACJ,CApCD,CAsCA,mBACI,kCACI,MAAC,IAAD,EAAM,QAAQ,CAAEM,UAAhB,wBACI,KAAC,IAAD,CAAM,OAAN,EACI,QAAQ,KADZ,CAEI,IAAI,CAAC,MAFT,CAGI,QAAQ,CAAE,kBAACC,CAAD,QAAOQ,UAAS,CAACR,CAAD,CAAhB,EAHd,CAII,SAAS,CAAC,MAJd,EADJ,CAQKY,mBAAmB,EARxB,GADJ,EADJ,CAcH,CAnFM"},"metadata":{},"sourceType":"module"}